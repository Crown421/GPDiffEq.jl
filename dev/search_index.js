var documenterSearchIndex = {"docs":
[{"location":"api/#API","page":"API","title":"API","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Modules = [GPDiffEq]","category":"page"},{"location":"api/#GPDiffEq.DerivativeGP","page":"API","title":"GPDiffEq.DerivativeGP","text":"DerivativeGP\n\nThe Gaussian Process (GP) \n\n\n\n\n\n","category":"type"},{"location":"api/#GPDiffEq.GPODE","page":"API","title":"GPDiffEq.GPODE","text":"Defines an ODE model with a GP vector field. The returned model can be evaluated for an initial value as input.\n\n    GPODE(model, tspan, args...; kwargs...)\n\nArguments:\n\nmodel: An AbstractGP.FiniteGP\ntspan: The time span for the ODE solver\nargs: Additional positional arguments from DifferentialEquations.jl\nkwargs: Additional keyword arguments from DifferentialEquations.jl\n\n\n\n\n\n","category":"type"},{"location":"api/#AbstractGPs.posterior-Tuple{AbstractGPs.FiniteGP{<:AbstractGPs.PosteriorGP{<:DerivativeGP}}, AbstractVector{<:Real}}","page":"API","title":"AbstractGPs.posterior","text":"posterior(fx::FiniteGP{<:PosteriorGP}, y::AbstractVector{<:Real})\n\nConstruct the posterior distribution over fx.f when f is itself a PosteriorGP by updating the Cholesky factorisation of the covariance matrix and avoiding recomputing it from the original covariance matrix. It does this by using update_chol functionality. Other aspects are similar to a regular posterior.\n\n\n\n\n\n","category":"method"},{"location":"api/#AbstractGPs.posterior-Tuple{AbstractGPs.FiniteGP{<:DerivativeGP}, AbstractVector{<:Real}}","page":"API","title":"AbstractGPs.posterior","text":"posterior(FiniteGP{<:DerivativeGP}, y::AbstractVector{<:Real})\n\nThe posterior of a derivative GP, conditioned on the data y from the output space of the undifferentiated GP. Evaluating this posterior at a point x will return the posterior of the derivative at x, and therefore not return the original data y.\n\n\n\n\n\n","category":"method"},{"location":"api/#GPDiffEq.differentiate-Tuple{AbstractGPs.PosteriorGP}","page":"API","title":"GPDiffEq.differentiate","text":"differentiate(gpp::PosteriorGP)\n\n\n\n\n\n","category":"method"},{"location":"api/#GPDiffEq.gp_negloglikelihood-Tuple{Any, Any, Any}","page":"API","title":"GPDiffEq.gp_negloglikelihood","text":"Returns two function function. 1) to compute the loglikelihood and 2) rebuild the GP from a new set of parameters.\n\n    gp_negloglikelihood(gp, x, y)\n\nArguments:\n\ngp: An AbstractGP.FiniteGP\nx: input data\ny: output data\n\n\n\n\n\n","category":"method"},{"location":"api/#GPDiffEq.gp_train","page":"API","title":"GPDiffEq.gp_train","text":"Simplified copy of sciml_train\n\ngp_train(loss, θ, opt=ADAGrad(0.5), adtype=Optimization.AutoZygote(), args...;\nlower_bounds=nothing, upper_bounds=nothing, maxiters=1000, kwargs...,)\n\n\n\n\n\n","category":"function"},{"location":"theory/#Theory","page":"Theory","title":"Theory","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"This packages uses GPs to learn the vector field of unknown dynamical systems. The rationale is that for many systems, the vector field is substantially simpler than the flow map (see e.g. emergence)","category":"page"},{"location":"theory/#Modelling-choices","page":"Theory","title":"Modelling choices","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"While GP models are sometimes referred to as non-parametric, there are some modelling choices that need to be made. ","category":"page"},{"location":"theory/#Kernel","page":"Theory","title":"Kernel","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"GPs represent a distribution over a function space, constrained by the available data points. The choice of kernel determines the Reproducing Kernel Hilbert Space (RKHS) underpinning the distribution, and therefore influences the accuracy of the model uncertainty behaviour. ","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"This package uses KernelFunction.jl, which means that all kernels implemented there are available. ","category":"page"},{"location":"theory/#Inducing-Points","page":"Theory","title":"Inducing Points","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"To limit the computational cost, we use inducing points by default. Various methods to select inducing points can be found in the InducingPoints.jl package.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"","category":"page"},{"location":"quickstart/#Quick-Start","page":"Quick Start","title":"Quick Start","text":"","category":"section"},{"location":"quickstart/#Setup","page":"Quick Start","title":"Setup","text":"","category":"section"},{"location":"quickstart/","page":"Quick Start","title":"Quick Start","text":"First we define an ODE and generate some data points from it. ","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"EditURL = \"https://github.com/Crown421/GPDiffEq.jl/blob/main/examples/derivativegp/script.jl\"","category":"page"},{"location":"examples/derivativegp/#Derivative-of-a-GP","page":"Derivative of a GP","title":"Derivative of a GP","text":"","category":"section"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"(Image: )","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"You are seeing the HTML output generated by Documenter.jl and Literate.jl from the Julia source file. The corresponding notebook can be viewed in nbviewer.","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"The derivative of a GP is also a GP, as differentiation is a linear operators. In this example, we show how to use of the DerivativeGP and how to easily generate it from a known GP.","category":"page"},{"location":"examples/derivativegp/#Setup","page":"Derivative of a GP","title":"Setup","text":"","category":"section"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"using GPDiffEq\nusing Plots","category":"page"},{"location":"examples/derivativegp/#The-toy-model","page":"Derivative of a GP","title":"The toy model","text":"","category":"section"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"We generate data for our model","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"σ_n = 3e-2\nx = collect(range(-3, 3; length=10))\ny = sin.(x) + σ_n * randn(length(x))","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"10-element Vector{Float64}:\n -0.09211555825625901\n -0.684290947847462\n -0.9977197964515279\n -0.8647952881488756\n -0.2964532789128859\n  0.3502572002238626\n  0.8247514316931458\n  0.9966601531803739\n  0.7883833614464482\n  0.19637445882770227","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"which looks as follows","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"x_plot = collect(range(-3, 3; length=50))\n\nplot(x_plot, sin.(x_plot); label=\"true\", linewidth=2.5)\nscatter!(x, y; label=\"data\", markersize=5)\n\n# Define a GP","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"(Image: )","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"We'll use a simple GP with a ZeroMean and GaussianKernel, condition it on our data","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"kernel = GaussianKernel()\nf = GP(kernel)\nfx = f(x, σ_n^2)\n\nf_post = posterior(fx, y)","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"AbstractGPs.PosteriorGP{AbstractGPs.GP{AbstractGPs.ZeroMean{Float64}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, NamedTuple{(:α, :C, :x, :δ), Tuple{Vector{Float64}, LinearAlgebra.Cholesky{Float64, Matrix{Float64}}, Vector{Float64}, Vector{Float64}}}}(AbstractGPs.GP{AbstractGPs.ZeroMean{Float64}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}(AbstractGPs.ZeroMean{Float64}(), Squared Exponential Kernel (metric = Distances.Euclidean(0.0))), (α = [1.6962973903098835, -3.4076709525230173, 3.6673506753511496, -5.037906818852361, 4.438684548184442, -3.963593653751669, 4.213589051523581, -3.352978089050717, 3.5722805184829767, -1.7566137181455306], C = LinearAlgebra.Cholesky{Float64, Matrix{Float64}}([1.0004498987955368 0.8003773141272065 0.4109274147582345 0.13527442343644172 0.028552654979465738 0.0038641816488032754 0.0003353117715403665 1.8656075767503327e-5 6.655367228157499e-7 1.5223130876467006e-8; 0.8007374029168073 0.6002467451228027 0.7860774360298166 0.5045287013510821 0.18739357913541801 0.042437043869301076 0.005993442252878988 0.0005339982776949294 3.0207225222272073e-5 1.0889719997540142e-6; 0.4111122905071873 0.800737402916808 0.4627320221952479 0.7532454836302187 0.5447501912681774 0.21694755843305388 0.05125299553180774 0.0074308448185643515 0.0006730546137433022 3.8471936975043666e-5; 0.1353352832366127 0.4111122905071873 0.800737402916808 0.4008401941766902 0.7284671118734966 0.5632271754070077 0.23365913510519642 0.05662183999427727 0.008341514642992735 0.0007632276968352209; 0.028565500784550377 0.13533528323661262 0.41111229050718734 0.8007374029168081 0.3708790752043206 0.7123614154783097 0.5712010291281239 0.242503787177178 0.059633063470279454 0.008867504227890321; 0.0038659201394728076 0.028565500784550366 0.1353352832366127 0.41111229050718745 0.8007374029168081 0.3568392984503521 0.7029993719303738 0.5740291337269634 0.24663628796656215 0.06112098575317586; 0.00033546262790251185 0.003865920139472804 0.028565500784550366 0.1353352832366127 0.41111229050718745 0.8007374029168081 0.3509441161144569 0.6982952225737459 0.5746810106111326 0.24824985985472933; 1.866446911352057e-5 0.00033546262790251185 0.003865920139472804 0.028565500784550366 0.1353352832366127 0.41111229050718734 0.800737402916808 0.3488620260888474 0.6963366393076491 0.5746726576516153; 6.658361469857302e-7 1.8664469113520537e-5 0.00033546262790251185 0.003865920139472804 0.028565500784550366 0.13533528323661262 0.4111122905071873 0.800737402916808 0.3482835414112316 0.6956902200185071; 1.522997974471263e-8 6.658361469857302e-7 1.866446911352057e-5 0.00033546262790251185 0.0038659201394728076 0.028565500784550377 0.1353352832366127 0.4111122905071873 0.8007374029168073 0.3481716098016506], 'U', 0), x = [-3.0, -2.3333333333333335, -1.6666666666666667, -1.0, -0.3333333333333333, 0.3333333333333333, 1.0, 1.6666666666666667, 2.3333333333333335, 3.0], δ = [-0.09211555825625901, -0.684290947847462, -0.9977197964515279, -0.8647952881488756, -0.2964532789128859, 0.3502572002238626, 0.8247514316931458, 0.9966601531803739, 0.7883833614464482, 0.19637445882770227]))","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"and plot the posterior. Note that this GP completely untrained, no hyperparameters have been defined.","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"plot(x_plot, sin.(x_plot); label=\"true\", linewidth=2.5)\nscatter!(x, y; label=\"data\", markersize=5)\nplot!(\n    x_plot,\n    mean(f_post, x_plot);\n    ribbons=sqrt.(var(f_post, x_plot)),\n    label=\"GP\",\n    linewidth=2.5,\n)","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"(Image: )","category":"page"},{"location":"examples/derivativegp/#Derivative-of-a-GP-2","page":"Derivative of a GP","title":"Derivative of a GP","text":"","category":"section"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"Now we can very easily generate the derivate of this GP","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"df_post = differentiate(f_post)","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"AbstractGPs.PosteriorGP{GPDiffEq.DerivativeGP{AbstractGPs.GP{AbstractGPs.ZeroMean{Float64}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, AbstractGPs.ZeroMean{Float64}, GPDiffEq.DerivativeKernelCollection{KernelFunctions.SqExponentialKernel{Distances.Euclidean}, GPDiffEq.FirstComponentDerivativeKernel{GPDiffEq.var\"#d10#12\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, GPDiffEq.SecondComponentDerivativeKernel{GPDiffEq.var\"#d01#15\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, GPDiffEq.BothComponentDerivativeKernel{GPDiffEq.var\"#d11#18\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}}}, NamedTuple{(:α, :C, :x, :δ), Tuple{Vector{Float64}, LinearAlgebra.Cholesky{Float64, Matrix{Float64}}, Vector{Float64}, Vector{Float64}}}}(GPDiffEq.DerivativeGP{AbstractGPs.GP{AbstractGPs.ZeroMean{Float64}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, AbstractGPs.ZeroMean{Float64}, GPDiffEq.DerivativeKernelCollection{KernelFunctions.SqExponentialKernel{Distances.Euclidean}, GPDiffEq.FirstComponentDerivativeKernel{GPDiffEq.var\"#d10#12\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, GPDiffEq.SecondComponentDerivativeKernel{GPDiffEq.var\"#d01#15\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, GPDiffEq.BothComponentDerivativeKernel{GPDiffEq.var\"#d11#18\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}}}(AbstractGPs.GP{AbstractGPs.ZeroMean{Float64}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}(AbstractGPs.ZeroMean{Float64}(), Squared Exponential Kernel (metric = Distances.Euclidean(0.0))), AbstractGPs.ZeroMean{Float64}(), GPDiffEq.DerivativeKernelCollection{KernelFunctions.SqExponentialKernel{Distances.Euclidean}, GPDiffEq.FirstComponentDerivativeKernel{GPDiffEq.var\"#d10#12\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, GPDiffEq.SecondComponentDerivativeKernel{GPDiffEq.var\"#d01#15\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, GPDiffEq.BothComponentDerivativeKernel{GPDiffEq.var\"#d11#18\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}}(GPDiffEq.FirstComponentDerivativeKernel{GPDiffEq.var\"#d10#12\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}(GPDiffEq.var\"#d10#12\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}(Squared Exponential Kernel (metric = Distances.Euclidean(0.0)))), GPDiffEq.SecondComponentDerivativeKernel{GPDiffEq.var\"#d01#15\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}(GPDiffEq.var\"#d01#15\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}(Squared Exponential Kernel (metric = Distances.Euclidean(0.0)))), GPDiffEq.BothComponentDerivativeKernel{GPDiffEq.var\"#d11#18\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}, KernelFunctions.SqExponentialKernel{Distances.Euclidean}}(GPDiffEq.var\"#d11#18\"{KernelFunctions.SqExponentialKernel{Distances.Euclidean}}(Squared Exponential Kernel (metric = Distances.Euclidean(0.0)))))), (α = [1.6962973903098835, -3.4076709525230173, 3.6673506753511496, -5.037906818852361, 4.438684548184442, -3.963593653751669, 4.213589051523581, -3.352978089050717, 3.5722805184829767, -1.7566137181455306], C = LinearAlgebra.Cholesky{Float64, Matrix{Float64}}([1.0004498987955368 0.8003773141272065 0.4109274147582345 0.13527442343644172 0.028552654979465738 0.0038641816488032754 0.0003353117715403665 1.8656075767503327e-5 6.655367228157499e-7 1.5223130876467006e-8; 0.8007374029168073 0.6002467451228027 0.7860774360298166 0.5045287013510821 0.18739357913541801 0.042437043869301076 0.005993442252878988 0.0005339982776949294 3.0207225222272073e-5 1.0889719997540142e-6; 0.4111122905071873 0.800737402916808 0.4627320221952479 0.7532454836302187 0.5447501912681774 0.21694755843305388 0.05125299553180774 0.0074308448185643515 0.0006730546137433022 3.8471936975043666e-5; 0.1353352832366127 0.4111122905071873 0.800737402916808 0.4008401941766902 0.7284671118734966 0.5632271754070077 0.23365913510519642 0.05662183999427727 0.008341514642992735 0.0007632276968352209; 0.028565500784550377 0.13533528323661262 0.41111229050718734 0.8007374029168081 0.3708790752043206 0.7123614154783097 0.5712010291281239 0.242503787177178 0.059633063470279454 0.008867504227890321; 0.0038659201394728076 0.028565500784550366 0.1353352832366127 0.41111229050718745 0.8007374029168081 0.3568392984503521 0.7029993719303738 0.5740291337269634 0.24663628796656215 0.06112098575317586; 0.00033546262790251185 0.003865920139472804 0.028565500784550366 0.1353352832366127 0.41111229050718745 0.8007374029168081 0.3509441161144569 0.6982952225737459 0.5746810106111326 0.24824985985472933; 1.866446911352057e-5 0.00033546262790251185 0.003865920139472804 0.028565500784550366 0.1353352832366127 0.41111229050718734 0.800737402916808 0.3488620260888474 0.6963366393076491 0.5746726576516153; 6.658361469857302e-7 1.8664469113520537e-5 0.00033546262790251185 0.003865920139472804 0.028565500784550366 0.13533528323661262 0.4111122905071873 0.800737402916808 0.3482835414112316 0.6956902200185071; 1.522997974471263e-8 6.658361469857302e-7 1.866446911352057e-5 0.00033546262790251185 0.0038659201394728076 0.028565500784550377 0.1353352832366127 0.4111122905071873 0.8007374029168073 0.3481716098016506], 'U', 0), x = [-3.0, -2.3333333333333335, -1.6666666666666667, -1.0, -0.3333333333333333, 0.3333333333333333, 1.0, 1.6666666666666667, 2.3333333333333335, 3.0], δ = [-0.09211555825625901, -0.684290947847462, -0.9977197964515279, -0.8647952881488756, -0.2964532789128859, 0.3502572002238626, 0.8247514316931458, 0.9966601531803739, 0.7883833614464482, 0.19637445882770227]))","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"and plot the new posterior. As we know, the derivative of sin is cos, so we can check the differentiated GP.","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"plot(x_plot, cos.(x_plot); label=\"true\", linewidth=2.5)\nplot!(\n    x_plot,\n    mean(df_post, x_plot);\n    ribbons=sqrt.(var(df_post, x_plot)),\n    label=\"GP\",\n    linewidth=2.5,\n)","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"(Image: )","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"As we saw above, the original GP was slighly off from the true function. This is reflected and amplified in the derivative as well.","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"","category":"page"},{"location":"examples/derivativegp/","page":"Derivative of a GP","title":"Derivative of a GP","text":"This page was generated using Literate.jl.","category":"page"},{"location":"#GPDiffEq.jl","page":"Home","title":"GPDiffEq.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The GPDiffEq.jl package facilitates learning the (nonlinear) vector field of unknown system using Gaussian Processes (GPs). ","category":"page"},{"location":"","page":"Home","title":"Home","text":"It bridges the Universal Differential Equations in the SciML community using Neural Networks and GP ecosystem by the JuliaGaussianProcesses organization.","category":"page"},{"location":"","page":"Home","title":"Home","text":"For the GP machinery, this package builds on ","category":"page"},{"location":"","page":"Home","title":"Home","text":"KernelFunctions.jl\nApproximateGPs.jl\nInducingPoints.jl.","category":"page"},{"location":"","page":"Home","title":"Home","text":"It further uses Flux.jl for training, and DifferentialEquations.jl for solvers. ","category":"page"},{"location":"symmetries/#Symmetries","page":"Symmetries","title":"Symmetries","text":"","category":"section"},{"location":"symmetries/","page":"Symmetries","title":"Symmetries","text":"In addition to the kernels from KernelFunctions, we implement Group-Integration-Matrix (GIM) Kernels. ","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"EditURL = \"https://github.com/Crown421/GPDiffEq.jl/blob/main/examples/spiral/script.jl\"","category":"page"},{"location":"examples/spiral/#Spiral-ODE","page":"Spiral ODE","title":"Spiral ODE","text":"","category":"section"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"(Image: )","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"You are seeing the HTML output generated by Documenter.jl and Literate.jl from the Julia source file. The corresponding notebook can be viewed in nbviewer.","category":"page"},{"location":"examples/spiral/#Setup","page":"Spiral ODE","title":"Setup","text":"","category":"section"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"Load necessary packages","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"using ApproximateGPs\nusing Plots\nusing LinearAlgebra\nusing DifferentialEquations\nusing InducingPoints\nusing GPDiffEq\nusing Optimization, OptimizationOptimJL","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"First we define an ODE and generate some data points from it.","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"u0 = [2.0; 0.0]\ndatasize = 10\ntspan = (0.0, 3.0)\ndatatspan = (0.0, 1.5)\ndatatsteps = range(datatspan[1], datatspan[2]; length=datasize)\n\nfunction trueODEfunc(u, p, t)\n    du = similar(u)\n    true_A = [-0.1 2.0; -2.0 -0.1]\n    return du .= ((u .^ 3)'true_A)'\nend\n\nprob_trueode = ODEProblem(trueODEfunc, u0, tspan)\nsol = solve(prob_trueode, Tsit5())\node_data = Array(sol(datatsteps))\n\ntraj = sol(datatsteps);\n\np = plot(sol)\nscatter!(p, datatsteps, ode_data[1, :]; markersize=4)#, markerstyle = :star)\nscatter!(p, datatsteps, ode_data[2, :]; m=(4, :pentagon), lab=\"pentagon\")#, markerstyle = :star)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"(Image: )","category":"page"},{"location":"examples/spiral/#Gradient-data","page":"Spiral ODE","title":"Gradient data","text":"","category":"section"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"For this example we get gradient observations from our trajectory data via finite differences","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"First, we set all necessary variables","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"scaker = with_lengthscale(SqExponentialKernel(), 1.0)\nmoker = IndependentMOKernel(scaker)\n##ToDo: make ODE data into col_vecs and add number programmatically\nx = MOInput(datatsteps, 2)\nσ_n = 1e-6\ny = ode_data'[:]","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"and build a finite GP from them","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"g = GP(moker)\ngt = g(x, σ_n)\ngt_post = posterior(gt, y)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"Now we use the following convenience functions to a loglikelihood loss function and a function to rebuild the gp with the optimal parameters. Note that we use optimize over the logarithm of the parameters, to ensure their positivity. For more details see this KernelFunctions.jl example","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"loss, buildgppost = gp_negloglikelihood(gt, x, y)\n\np0 = log.([1.0])\nunfl(x) = exp.(x)\n\n#optp = gp_train(loss ∘ unfl, p0; show_trace=true, show_every=15)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"unfl (generic function with 1 method)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"Optimizing:","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"adtype = Optimization.AutoZygote()\n\noptf = Optimization.OptimizationFunction((x, p) -> (loss ∘ unfl)(x), adtype)\noptprob = Optimization.OptimizationProblem(optf, p0)\n\noptp = Optimization.solve(optprob, NelderMead(); maxiters=300)\n\noptparams = unfl(optp)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"1-element Vector{Float64}:\n 4.850137029269082","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"Now we can build a FiniteGP with the optimized parameters,","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"optpost = buildgppost(optparams)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"which fits pretty well","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"t_plot = range(datatspan...; length=100)\nt_plot_mo = MOInput(t_plot, 2)\nopt_pred_mean = mean(optpost, t_plot_mo)\nopt_pred_mean = reshape(opt_pred_mean, :, 2)\npred_mean = mean(gt_post, t_plot_mo)\npred_mean = reshape(pred_mean, :, 2)\n# pred_cov = diag(cov(optpost, t_plot_mo))\n# pred_cov = reshape(pred_cov, :, 2)\n# plot!(t_plot, pred_mean; ribbons = pred_cov)\nplot(sol(t_plot); label=[\"ode\" \"\"], color=[:skyblue :navy], linewidth=3.5)\nplot!(\n    t_plot,\n    pred_mean;\n    label=[\"gp\" \"\"],\n    color=[:limegreen :darkgreen],\n    linewidth=2.5,\n    linestyle=:dashdot,\n)\nplot!(\n    t_plot,\n    opt_pred_mean;\n    label=[\"opt. gp\" \"\"],\n    color=[:tomato :firebrick],\n    linewidth=2.5,\n    linestyle=:dash,\n)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"(Image: )","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"GPs are closed under linear operators, which means that we can very easily obtain derivative information:","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"deriv_post = differentiate(optpost)\ndu_pred_mean = mean(deriv_post, x)\ndu_pred_mean = reshape(du_pred_mean, :, 2)\n\ndu = trueODEfunc.(eachcol(ode_data), 0, 0)\nsf = maximum(norm.(du))\nquiver(\n    ode_data[1, :], ode_data[2, :]; quiver=(getindex.(du, 1) / sf, getindex.(du, 2) / sf)\n)\nquiver!(\n    ode_data[1, :],\n    ode_data[2, :];\n    quiver=(du_pred_mean[:, 1] / sf, du_pred_mean[:, 2] / sf),\n)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"(Image: )","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"This leaves us with u and udot pairs as in the input and output:","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"u = ColVecs(ode_data)\nudot = ColVecs(du_pred_mean')","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"10-element KernelFunctions.ColVecs{Float64, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, SubArray{Float64, 1, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, false}}:\n [1.9665562223554744, 13.067907128636275]\n [-12.054434025925604, 5.698910098229419]\n [-9.222248503633512, -5.09559517176834]\n [-1.1609557808123154, -9.630669683411604]\n [3.43351932843993, -6.938377634242549]\n [8.047485387715085, -0.47591973982619784]\n [6.254928975733939, 1.5856426721382908]\n [1.9298155930323255, 5.402080579409512]\n [-1.0141615123047787, 6.271334947651146]\n [-0.8774355877457074, 3.466106872440432]","category":"page"},{"location":"examples/spiral/#Building-a-model","page":"Spiral ODE","title":"Building a model","text":"","category":"section"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"Now we build a model for the the ODE.","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"scaker = with_lengthscale(SqExponentialKernel(), ones(2))\nmoker = IndependentMOKernel(scaker)\n\nu_mo = MOInput(u, 2)\nσ_n = 1e-6\ny = reduce(vcat, udot.X)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"and build a posterior GP","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"gpmodel = GP(moker)\nfin_gpmodel = gpmodel(u_mo, σ_n)\npost_gpmodel = posterior(fin_gpmodel, y)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"AbstractGPs.PosteriorGP{AbstractGPs.GP{AbstractGPs.ZeroMean{Float64}, KernelFunctions.IndependentMOKernel{KernelFunctions.TransformedKernel{KernelFunctions.SqExponentialKernel{Distances.Euclidean}, KernelFunctions.ARDTransform{Vector{Float64}}}}}, NamedTuple{(:α, :C, :x, :δ), Tuple{Vector{Float64}, LinearAlgebra.Cholesky{Float64, Matrix{Float64}}, KernelFunctions.MOInputIsotopicByOutputs{SubArray{Float64, 1, Matrix{Float64}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, true}, KernelFunctions.ColVecs{Float64, Matrix{Float64}, SubArray{Float64, 1, Matrix{Float64}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, true}}, Int64}, Vector{Float64}}}}(AbstractGPs.GP{AbstractGPs.ZeroMean{Float64}, KernelFunctions.IndependentMOKernel{KernelFunctions.TransformedKernel{KernelFunctions.SqExponentialKernel{Distances.Euclidean}, KernelFunctions.ARDTransform{Vector{Float64}}}}}(AbstractGPs.ZeroMean{Float64}(), Independent Multi-Output Kernel\n\tSquared Exponential Kernel (metric = Distances.Euclidean(0.0))\n\t- ARD Transform (dims: 2)), (α = [-7.4418838613573906, 73.26283521765956, -20.870885806635783, 16.182709580681525, -9.84381419942404, -11.490903040509766, 35.83832833434085, -75.5451302564706, 109.19500627035313, -114.43021223611966, 32.03259270366766, -22.739590693888207, 7.206040750684657, -0.0808681894161108, -4.911649818380245, 16.220752989580607, -24.108200784389112, 38.88283835973427, -73.44537484605277, 46.950873120532975], C = LinearAlgebra.Cholesky{Float64, Matrix{Float64}}([1.000000499999875 0.12270169800141326 0.0027022961653387877 0.0008874231473715965 0.0009882975233571549 0.01165265156481762 0.14143244266890873 0.5612266680267186 0.8465243684498069 0.47629343845451166 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.12270175935224692 0.9924441008477857 0.1213381250836824 0.007731028276590347 0.00032370754478580914 -0.0006692224996050956 -0.013996875519405361 -0.047490186514589756 0.10715197247792077 0.6306784863089335 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0027022975164865326 0.12075288277522109 0.9926080580957478 0.3415388285936147 0.016353874435246944 0.0035572995620148998 0.002539342482096629 0.005967748281641656 -0.00056040847911749 -0.01820347935026601 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0008874235910830593 0.007781501733617765 0.3399546599708229 0.9398359815653184 0.3127520582847639 0.05935043353777904 0.006459159664257307 0.0005342996571924631 0.0054641743672233355 0.011284956707029207 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0009882980175057931 0.0004425274274691109 0.0162749362846795 0.29952450043249684 0.9496939608689899 0.5126667080634749 0.0670282730209708 0.0108916313906103 0.0032806503938072064 -0.0018952449258547682 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.011652657391141946 0.0007656342113342606 0.003481290922590202 0.056999795940332 0.5055079221201767 0.8564475967359699 0.49178808953338016 0.12306335493068828 0.027270481271312045 0.002617574194318725 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.1414325133851124 0.003462884328427997 0.0012044095249183217 0.006955134902866922 0.06585323610198347 0.45760370858774474 0.8563909552543888 0.59521070689133 0.09324848508037172 -0.025653543003387104 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.5612269486399825 0.021732109675988178 0.0016778655143843278 0.0026712693615452416 0.011147701673635373 0.11760559168448552 0.6510431833702492 0.5596386398610604 0.12397078150101111 -0.10504754755815057 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.8465247917118853 0.21021232038828205 0.014732913022019794 0.0065236466728673965 0.005686684635727396 0.03515247095694577 0.21174844072315316 0.598276023493483 0.49705864915926834 0.43022061770059056 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.4762936766011714 0.6843551569142122 0.05974351070319892 0.009687280383372318 0.0021066683717152566 0.0070032152426523055 0.03775327725047467 0.16349849133866065 0.6693393737064282 0.42206418401072304 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.000000499999875 0.12270169800141326 0.0027022961653387877 0.0008874231473715965 0.0009882975233571549 0.01165265156481762 0.14143244266890873 0.5612266680267186 0.8465243684498069 0.47629343845451166; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.12270175935224692 0.9924441008477857 0.1213381250836824 0.007731028276590347 0.0003237075447858091 -0.0006692224996050955 -0.013996875519405363 -0.047490186514589756 0.10715197247792077 0.6306784863089335; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0027022975164865326 0.12075288277522109 0.9926080580957478 0.3415388285936147 0.016353874435246944 0.0035572995620148998 0.00253934248209663 0.005967748281641656 -0.00056040847911749 -0.01820347935026601; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0008874235910830593 0.007781501733617765 0.3399546599708229 0.9398359815653184 0.3127520582847639 0.05935043353777904 0.006459159664257307 0.0005342996571924631 0.005464174367223336 0.011284956707029207; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0009882980175057931 0.0004425274274691109 0.0162749362846795 0.29952450043249684 0.9496939608689899 0.5126667080634749 0.06702827302097077 0.0108916313906103 0.0032806503938072064 -0.0018952449258547686; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.011652657391141946 0.0007656342113342606 0.003481290922590202 0.056999795940332 0.5055079221201767 0.8564475967359699 0.49178808953338016 0.12306335493068826 0.027270481271312045 0.0026175741943187253; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.1414325133851124 0.003462884328427997 0.0012044095249183217 0.006955134902866922 0.06585323610198347 0.45760370858774474 0.8563909552543888 0.59521070689133 0.09324848508037172 -0.0256535430033871; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.5612269486399825 0.021732109675988178 0.0016778655143843278 0.0026712693615452416 0.011147701673635373 0.11760559168448552 0.6510431833702492 0.5596386398610604 0.12397078150101111 -0.10504754755815052; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.8465247917118853 0.21021232038828205 0.014732913022019794 0.0065236466728673965 0.005686684635727396 0.03515247095694577 0.21174844072315316 0.598276023493483 0.49705864915926823 0.43022061770059067; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.4762936766011714 0.6843551569142122 0.05974351070319892 0.009687280383372318 0.0021066683717152566 0.0070032152426523055 0.03775327725047467 0.16349849133866065 0.6693393737064282 0.42206418401072304], 'U', 0), x = Tuple{SubArray{Float64, 1, Matrix{Float64}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, true}, Int64}[([2.0, 0.0], 1), ([1.0968335224363548, 1.8385558167331164], 1), ([-0.9576760631528309, 1.7548385045374404], 1), ([-1.715872629998389, 0.496655682922846], 1), ([-1.5690755776160907, -1.0491673166662385], 1), ([-0.5298628588298211, -1.5824777916258712], 1), ([0.7182148654337268, -1.5062842011252175], 1), ([1.4264889494226716, -0.9090351474695393], 1), ([1.4322861125730242, 0.1045587063270885], 1), ([1.2893454342143849, 0.9891467953863277], 1), ([2.0, 0.0], 2), ([1.0968335224363548, 1.8385558167331164], 2), ([-0.9576760631528309, 1.7548385045374404], 2), ([-1.715872629998389, 0.496655682922846], 2), ([-1.5690755776160907, -1.0491673166662385], 2), ([-0.5298628588298211, -1.5824777916258712], 2), ([0.7182148654337268, -1.5062842011252175], 2), ([1.4264889494226716, -0.9090351474695393], 2), ([1.4322861125730242, 0.1045587063270885], 2), ([1.2893454342143849, 0.9891467953863277], 2)], δ = [1.9665562223554744, 13.067907128636275, -12.054434025925604, 5.698910098229419, -9.222248503633512, -5.09559517176834, -1.1609557808123154, -9.630669683411604, 3.43351932843993, -6.938377634242549, 8.047485387715085, -0.47591973982619784, 6.254928975733939, 1.5856426721382908, 1.9298155930323255, 5.402080579409512, -1.0141615123047787, 6.271334947651146, -0.8774355877457074, 3.466106872440432]))","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"and optimize","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"loss, buildgppost = gp_negloglikelihood(fin_gpmodel, u_mo, y)\n\np0 = log.(ones(2))\nunfl(x) = exp.(x)\n\noptf = Optimization.OptimizationFunction((x, p) -> (loss ∘ unfl)(x), adtype)\noptprob = Optimization.OptimizationProblem(optf, p0)\n\noptp = Optimization.solve(optprob, NelderMead(); maxiters=300)\n\noptparams = unfl(optp)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"2-element Vector{Float64}:\n  2.1450944708189903\n 38.2853899274332","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"We build a posterior GP with the optimized parameters,","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"optpost = buildgppost(optparams)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"and incorporate into a GP ode model. Unfortunately, this does not currently match the previous implementation.","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"gpode = GPODE(optpost, tspan)\ngpsol = gpode(u0)\n\nplot(gpsol)","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"(Image: )","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"","category":"page"},{"location":"examples/spiral/","page":"Spiral ODE","title":"Spiral ODE","text":"This page was generated using Literate.jl.","category":"page"}]
}
