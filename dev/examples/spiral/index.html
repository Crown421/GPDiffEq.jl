<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spiral ODE · GPDiffEq.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GPDiffEq.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../theory/">Theory</a></li><li><a class="tocitem" href="../../symmetries/">Symmetries</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Spiral ODE</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Gradient-data"><span>Gradient data</span></a></li><li><a class="tocitem" href="#Building-a-model"><span>Building a model</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Spiral ODE</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spiral ODE</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Crown421/GPDiffEq.jl/blob/main/examples/spiral/script.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Spiral-ODE"><a class="docs-heading-anchor" href="#Spiral-ODE">Spiral ODE</a><a id="Spiral-ODE-1"></a><a class="docs-heading-anchor-permalink" href="#Spiral-ODE" title="Permalink"></a></h1><p><a href="https://nbviewer.jupyter.org/github/Crown421/GPDiffEq.jl/blob/gh-pages/dev/examples/spiral.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p><em>You are seeing the HTML output generated by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a> from the <a href="https://github.com/Crown421/GPDiffEq.jl/blob/main/examples/spiral/script.jl">Julia source file</a>. The corresponding notebook can be viewed in <a href="https://nbviewer.jupyter.org/github/Crown421/GPDiffEq.jl/blob/gh-pages/dev/examples/spiral.ipynb">nbviewer</a>.</em></p><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><p>Load necessary packages</p><pre><code class="language-julia hljs">using ApproximateGPs
using Plots
using LinearAlgebra
using DifferentialEquations
using InducingPoints
using GPDiffEq</code></pre><p>First we define an ODE and generate some data points from it.</p><pre><code class="language-julia hljs">u0 = [2.0; 0.0]
datasize = 20
tspan = (0.0, 3.0)
datatspan = (0.0, 1.5)
datatsteps = range(datatspan[1], datatspan[2]; length=datasize)

function trueODEfunc(u, p, t)
    du = similar(u)
    true_A = [-0.1 2.0; -2.0 -0.1]
    return du .= ((u .^ 3)&#39;true_A)&#39;
end

prob_trueode = ODEProblem(trueODEfunc, u0, tspan)
sol = solve(prob_trueode, Tsit5())
ode_data = Array(sol(datatsteps))

traj = sol(datatsteps);

p = plot(sol)
scatter!(p, datatsteps, ode_data[1, :]; markersize=4)#, markerstyle = :star)
scatter!(p, datatsteps, ode_data[2, :]; m=(4, :pentagon), lab=&quot;pentagon&quot;)#, markerstyle = :star)</code></pre><p><img src="../1187188243.svg" alt/></p><h2 id="Gradient-data"><a class="docs-heading-anchor" href="#Gradient-data">Gradient data</a><a id="Gradient-data-1"></a><a class="docs-heading-anchor-permalink" href="#Gradient-data" title="Permalink"></a></h2><p>For this example we get gradient observations from our trajectory data via finite differences</p><p>First, we set all necessary variables</p><pre><code class="language-julia hljs">scaker = with_lengthscale(SqExponentialKernel(), 1.0)
moker = IndependentMOKernel(scaker)
##ToDo: make ODE data into col_vecs and add number programmatically
x = MOInput(datatsteps, 2)
σ_n = 1e-6
y = ode_data&#39;[:]</code></pre><p>and build a finite GP from them</p><pre><code class="language-julia hljs">g = GP(moker)
gt = g(x, σ_n)</code></pre><p>Now we use the following convenience functions to a loglikelihood loss function and a function to rebuild the gp with the optimal parameters. Note that we use optimize over the logarithm of the parameters, to ensure their positivity. For more details see <a href="https://juliagaussianprocesses.github.io/KernelFunctions.jl/dev/examples/train-kernel-parameters/">this KernelFunctions.jl example</a></p><pre><code class="language-julia hljs">loss, buildgppost = gp_negloglikelihood(gt, x, y)

p0 = log.([1.0])
unfl(x) = exp.(x)
optp = gp_train(loss ∘ unfl, p0; show_trace=true, show_every=15)
optparams = unfl(optp)</code></pre><pre><code class="nohighlight hljs">1-element Vector{Float64}:
 7.160713088339386</code></pre><p>Now we can build a FiniteGP with the optimized parameters,</p><pre><code class="language-julia hljs">optpost = buildgppost(optparams)</code></pre><p>which fits pretty well</p><pre><code class="language-julia hljs">t_plot = range(datatspan...; length=100)
plot(sol(t_plot); label=[&quot;ode&quot; &quot;&quot;], color=[:skyblue :navy], linewidth=2.5)
t_plot_mo = MOInput(t_plot, 2)
pred_mean = mean(optpost, t_plot_mo)
pred_mean = reshape(pred_mean, :, 2)
# pred_cov = diag(cov(optpost, t_plot_mo))
# pred_cov = reshape(pred_cov, :, 2)
# plot!(t_plot, pred_mean; ribbons = pred_cov)
plot!(
    t_plot,
    pred_mean;
    label=[&quot;gp&quot; &quot;&quot;],
    color=[:tomato :firebrick],
    linewidth=3.5,
    linestyle=:dash,
)</code></pre><p><img src="../2863055322.svg" alt/></p><p>GPs are closed under linear operators, which means that we can very easily obtain derivative information:</p><pre><code class="language-julia hljs">deriv_post = build_deriv_model(optpost)
du_pred_mean = mean(deriv_post, x)
du_pred_mean = reshape(du_pred_mean, :, 2)
du_pred_mean = du_pred_mean ./ norm.(eachrow(du_pred_mean))

du = trueODEfunc.(eachcol(ode_data), 0, 0)
du = du ./ maximum(norm.(du))
quiver(ode_data[1, :], ode_data[2, :]; quiver=(getindex.(du, 1), getindex.(du, 2)))
quiver!(ode_data[1, :], ode_data[2, :]; quiver=(du_pred_mean[:, 1], du_pred_mean[:, 2]))</code></pre><p><img src="../5833590.svg" alt/></p><p>This leaves us with <code>u</code> and <code>udot</code> pairs as in the input and output:</p><pre><code class="language-julia hljs">u = ColVecs(ode_data)
udot = ColVecs(du_pred_mean&#39;)</code></pre><pre><code class="nohighlight hljs">20-element KernelFunctions.ColVecs{Float64, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, SubArray{Float64, 1, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, false}}:
 [-0.043711303483780516, 0.9990442042010698]
 [-0.310482241639859, 0.9505791800930042]
 [-0.9679885818073968, 0.25099423397860116]
 [-0.9981745514937379, -0.060395072235034826]
 [-0.9925640431588979, -0.12172354015580261]
 [-0.6641107188284132, -0.7476342375367839]
 [-0.034397323590253395, -0.9994082369731737]
 [0.045578854731326744, -0.9989607439741467]
 [0.1531189470772444, -0.9882077656272268]
 [0.6867685284040238, -0.7268761850506394]
 [0.9917569391235823, -0.128133421480202]
 [0.9987719487914493, 0.04954386245874081]
 [0.9983253771890384, 0.05784843351694462]
 [0.9627106801116336, 0.2705330781974648]
 [0.62712952663302, 0.7789149869048895]
 [0.11581090255516366, 0.9932712795854708]
 [-0.03217748787311947, 0.9994821705634248]
 [-0.06244417281112426, 0.998048458383627]
 [-0.10704664464071242, 0.9942539996757191]
 [-0.5416232070250678, 0.8406213782743576]</code></pre><h2 id="Building-a-model"><a class="docs-heading-anchor" href="#Building-a-model">Building a model</a><a id="Building-a-model-1"></a><a class="docs-heading-anchor-permalink" href="#Building-a-model" title="Permalink"></a></h2><p>Now we build a model for the the ODE.</p><pre><code class="language-julia hljs">scaker = with_lengthscale(SqExponentialKernel(), ones(2))
moker = IndependentMOKernel(scaker)

u_mo = MOInput(u, 2)
σ_n = 1e-6
y = reduce(vcat, udot.X)</code></pre><p>and build a posterior GP</p><pre><code class="language-julia hljs">gpmodel = GP(moker)
fin_gpmodel = gpmodel(u_mo, σ_n)
post_gpmodel = posterior(fin_gpmodel, y)</code></pre><pre><code class="nohighlight hljs">AbstractGPs.PosteriorGP{AbstractGPs.GP{AbstractGPs.ZeroMean{Float64}, KernelFunctions.IndependentMOKernel{KernelFunctions.TransformedKernel{KernelFunctions.SqExponentialKernel{Distances.Euclidean}, KernelFunctions.ARDTransform{Vector{Float64}}}}}, NamedTuple{(:α, :C, :x, :δ), Tuple{Vector{Float64}, LinearAlgebra.Cholesky{Float64, Matrix{Float64}}, KernelFunctions.MOInputIsotopicByOutputs{SubArray{Float64, 1, Matrix{Float64}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, true}, KernelFunctions.ColVecs{Float64, Matrix{Float64}, SubArray{Float64, 1, Matrix{Float64}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, true}}}, Vector{Float64}}}}(AbstractGPs.GP{AbstractGPs.ZeroMean{Float64}, KernelFunctions.IndependentMOKernel{KernelFunctions.TransformedKernel{KernelFunctions.SqExponentialKernel{Distances.Euclidean}, KernelFunctions.ARDTransform{Vector{Float64}}}}}(AbstractGPs.ZeroMean{Float64}(), Independent Multi-Output Kernel
	Squared Exponential Kernel (metric = Distances.Euclidean(0.0))
	- ARD Transform (dims: 2)), (α = [1.792779283999211, -17.0916336342555, 16.993195258277506, 1.334651233420452, -0.3773658595484156, -1.9983049312099255, 2.876518780069521, -2.4112761869374677, 3.466861308222191, -10.080037353295818, 25.118397961368952, -48.073268078331616, 84.66038935325221, -142.2712330061735, 238.5921285888284, -369.1829542410151, 502.71094120447543, -548.8954423080323, 417.2370615372029, -154.7599509885428, 0.9920828754021197, -2.525372313151282, 2.27225063757959, -1.1250431635231, 2.5255102573071175, -3.593015487971291, 3.6445431906417194, -6.749820210933849, 11.697339339450757, -22.56948382341921, 34.86934014333857, -49.8936711949166, 68.70632260683857, -88.6703606601173, 105.01602329714044, -115.87791652898198, 124.99045594018115, -115.9822785277943, 76.58527483587412, -24.34849224310046], C = LinearAlgebra.Cholesky{Float64, Matrix{Float64}}([1.000000499999875 0.4954890097390399 0.13993834623708593 0.03530424134314175 0.00444576739272158 0.0007560986595125537 0.0007509268990312181 0.001093377520541939 0.0010029710830390041 0.0012604227250751637 0.004673259185560229 0.022892467481398317 0.07722260972802414 0.18355091218552266 0.36409817560599433 0.6199106031869643 0.8186728373742853 0.8396223009285089 0.6945431160676236 0.47629343845451166 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.4954892574834829 0.8686147829894594 0.6717575882034632 0.20411670261425433 0.027115051171701512 0.0034162079323442635 0.0012651869851848753 0.00034639899320036666 -0.00020036865567015383 -0.0004882452235482161 -0.0020584192224736234 -0.01033045972290571 -0.03521109035917444 -0.08334689542730384 -0.15419934127445 -0.20642957902388837 -0.1221812245170763 0.14012518189977033 0.47467588100184205 0.6824889460247667 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.13993841620624156 0.6528364843004064 0.7274338471252871 0.6275165461963711 0.17190998412922162 0.03093624738966359 0.009771438084674415 0.0032465327822652273 0.0008644072809057171 0.0005292673332924165 0.0015142617286606863 0.00664911106331592 0.021016811067991435 0.047559406169392575 0.08560574464996032 0.11440624409550348 0.09217133133930441 0.04646716595292083 0.07408690215492825 0.2504943954020989 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.03530425899525801 0.1947916489285059 0.5985341363433084 0.750542448171219 0.690521003904372 0.27453815683958377 0.11109297507710977 0.03596437202185668 0.007563255149946895 0.0019857610302539946 0.001265963312525278 -0.00038304006988596823 -0.007454286470852762 -0.021500316813582665 -0.04034587794177437 -0.05066883944304677 -0.024693584099596315 0.031278779144743606 0.07345210410367065 0.0868603690059326 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0044457696156047204 0.02575536317220532 0.14389001583017466 0.6318332735628499 0.7020496490105488 0.7645947470968396 0.4245000116879691 0.1426506749886009 0.030217985286780522 0.0068406292231288504 0.003527470057632727 0.0034138700357493872 0.00607006088677481 0.013361084643559914 0.024218515826061025 0.030207467794653938 0.014614962367151737 -0.01889180342749871 -0.04443412913733323 -0.050201360992342944 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.000756099037561789 0.0033420072878669726 0.024904744251719995 0.22618954605318292 0.7317720793950104 0.582284620771208 0.6866042591025339 0.33831432540573736 0.09519854226938353 0.02283136931570631 0.008433499200752391 0.0029495595847464483 -0.002148046892144421 -0.0083793737840418 -0.015964153380994984 -0.019738987182315426 -0.008291566843657557 0.015733920651725165 0.034245691104336055 0.03895578330148332 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0007509272744945739 0.0014710361441648348 0.008063057224070832 0.08979648926734561 0.37644956870970486 0.7551760218686556 0.579599893681955 0.7509690001498737 0.4019963703804608 0.14964191794166706 0.06732159282466474 0.03255798213097692 0.013617744728781416 0.008177206948236062 0.009953613126145715 0.012122844601921076 0.007870908413687368 -0.0027747739356427134 -0.011808040176421272 -0.013942055754670462 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0010933780672305626 0.0008426438312307558 0.002747339425887387 0.029139347547010506 0.12555437550781734 0.3160412234568 0.7321331942690971 0.5476636481160299 0.7733446561368161 0.5228258849523095 0.30015314747570176 0.14822385988239573 0.053864978702514 0.014178321608387013 0.0019156636796664787 -0.0008996045266914172 0.0024840535008976523 0.00862917770302064 0.01239036300391782 0.012348067986445884 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0010029715845244203 0.00032291797236906817 0.0006345540636318991 0.006213484451678832 0.026584738715043233 0.08064037739158374 0.31203748389523345 0.7622130558318682 0.4798990266853592 0.7468919646687945 0.5844828076198829 0.30765026330237055 0.11712490041254725 0.03729012800968887 0.015936314608858453 0.010587255311379471 0.004540911141704423 -0.003378040870381006 -0.008340303004659872 -0.00909341958404065 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0012604233552863688 0.00020042858900210121 0.00023340601029869334 0.0017673612171146685 0.006257022136131831 0.01908549016957994 0.10553850689527879 0.407483516586202 0.8253099003974074 0.3818896011665412 0.6384255680668788 0.49786425123130024 0.24931184274521026 0.0913745158530045 0.031879726712965226 0.013900201357947164 0.008564348789880986 0.008126305564241394 0.008576714724509837 0.008130875221301848 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.004673261522189239 0.0005275751998768523 0.00037273466439827105 0.0016452116197411277 0.003575912163823596 0.007998684227319384 0.04646381673101477 0.2183506088477983 0.5406030322752023 0.8475824543762518 0.3950392306957154 0.7062601948609509 0.5805838568716436 0.31085924772074386 0.14745942962691233 0.08013178552578919 0.04253347323784408 0.016258572972928192 0.0026582731020349153 -0.0011585015441411743 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.022892478927629197 0.002369776012448131 0.0011007577728922007 0.0025845211997026314 0.0030969212655942487 0.004410267676370807 0.022371509947614165 0.10714098666486373 0.2757692174546693 0.5024053515494593 0.8235225022755663 0.36736114366996875 0.6945261454289443 0.633166227977119 0.4145642571593715 0.25055045328496856 0.13333221238327456 0.056190000709552615 0.02069962075466177 0.011351724060205659 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.07722264833931936 0.0076780808124464845 0.0024414268892526884 0.0031327522676623857 0.0021157056383434383 0.0019321567023818755 0.008385411698039644 0.03973795754626482 0.10336383282988214 0.21299236381298908 0.47452150176198155 0.8360581365295573 0.30635505138239805 0.6278836459586838 0.6260839649274265 0.43229724883745935 0.2129428586120646 0.06541212290282561 0.007832072511157423 0.0010158152584573902 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.1835510039609558 0.018551114231069425 0.004293223441854103 0.0031750461156396376 0.0012657305195947024 0.0007593391266956595 0.002766548679191313 0.01252986275541879 0.031832768466182736 0.07153772912287462 0.20878964043172557 0.5168887098786058 0.8589770428863565 0.23369189141742402 0.46416002703673276 0.39779588780101094 0.17704189661746386 0.020138612268851358 -0.023997278471858834 -0.011008422711275417 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.3640983576550366 0.046466817120581226 0.009639235131901278 0.004817275991235866 0.0012969793671893117 0.0005420236436424839 0.001521485391672366 0.005749470061052732 0.012507605828791174 0.026868859928768796 0.09121296130185183 0.28837043298022 0.6112228781738439 0.89860009840827 0.17734729139958275 0.34006673203900084 0.2641692805887435 0.09630168400196554 0.008204113055605653 0.006316655894332819 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.6199109131421885 0.12785110691339965 0.0313016027634215 0.013512444910211011 0.003045449638059449 0.000995039824148341 0.0019898941479791986 0.005397773280789716 0.008670921362068158 0.015157670386368121 0.05063472648874113 0.17622413609964763 0.4159432932340139 0.6877850537918145 0.9024459201416005 0.16038348230900584 0.33310191276347617 0.3223371513459543 0.21134352224057826 0.1293263816675643 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.8186732467106017 0.29951497567154806 0.09953610441685301 0.043268847198067645 0.009380841676123798 0.0026201766104041613 0.0036905483603607734 0.006814855455023468 0.007655070755526318 0.010140694767973905 0.030366960655628043 0.10595750831473474 0.25519104275719634 0.4394023031189203 0.650611366658185 0.8879425239532279 0.16816779401419604 0.36939848709505574 0.395554373289144 0.2958120204770125 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.8396227207395545 0.5377384269091086 0.24542729978941608 0.110879085397081 0.023856106697302353 0.005855318526244986 0.005911830672264455 0.007512542172206589 0.005954511097352038 0.005983219425981332 0.01585103047646528 0.05437242366700922 0.13106040359884066 0.2307130303037917 0.379370764743143 0.6305669564270212 0.8940230413025004 0.11731255865900693 0.265298410290254 0.30763188103172084 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.6945434633390949 0.7564489681681593 0.46995366030916136 0.22302927242942652 0.048220172014827936 0.01057074816652166 0.00781306340221759 0.006971538081022406 0.00397123319735068 0.0030637260089022467 0.007180966413035531 0.024047893475625633 0.05757403523141519 0.10277901181800257 0.18568307383293076 0.3711052091886543 0.6540400265326823 0.9044131811185793 0.07192846736054632 0.17622816482926978 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.4762936766011714 0.828818151909036 0.7073369461886921 0.3785043435816474 0.08842076141261883 0.018587147771367517 0.010674319341562221 0.007004876721805198 0.002986718635318442 0.0018010448066119336 0.0036477879415751165 0.01140773409765339 0.025938138188051386 0.04494698968018632 0.08546074908935598 0.1978829483969842 0.4206024784360143 0.6998208525062006 0.9229216758526686 0.04809075252154027 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.000000499999875 0.4954890097390399 0.13993834623708593 0.03530424134314175 0.00444576739272158 0.0007560986595125537 0.0007509268990312181 0.001093377520541939 0.0010029710830390041 0.0012604227250751637 0.004673259185560229 0.022892467481398317 0.07722260972802414 0.18355091218552266 0.36409817560599433 0.6199106031869643 0.8186728373742853 0.8396223009285089 0.6945431160676236 0.47629343845451166; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.4954892574834829 0.8686147829894594 0.6717575882034632 0.20411670261425433 0.027115051171701512 0.0034162079323442635 0.0012651869851848753 0.00034639899320036666 -0.00020036865567015383 -0.0004882452235482161 -0.0020584192224736234 -0.01033045972290571 -0.03521109035917444 -0.08334689542730384 -0.15419934127445 -0.20642957902388837 -0.1221812245170763 0.14012518189977033 0.47467588100184205 0.6824889460247667; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.13993841620624156 0.6528364843004064 0.7274338471252871 0.6275165461963711 0.17190998412922162 0.03093624738966359 0.009771438084674415 0.0032465327822652273 0.0008644072809057171 0.0005292673332924165 0.0015142617286606863 0.00664911106331592 0.021016811067991435 0.047559406169392575 0.08560574464996032 0.11440624409550348 0.09217133133930441 0.04646716595292083 0.07408690215492825 0.2504943954020989; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.03530425899525801 0.1947916489285059 0.5985341363433084 0.750542448171219 0.690521003904372 0.27453815683958377 0.11109297507710977 0.03596437202185668 0.007563255149946895 0.0019857610302539946 0.001265963312525278 -0.00038304006988596823 -0.007454286470852762 -0.021500316813582665 -0.04034587794177437 -0.05066883944304677 -0.024693584099596315 0.031278779144743606 0.07345210410367065 0.0868603690059326; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0044457696156047204 0.02575536317220532 0.14389001583017466 0.6318332735628499 0.7020496490105488 0.7645947470968396 0.4245000116879691 0.1426506749886009 0.030217985286780522 0.0068406292231288504 0.003527470057632727 0.0034138700357493872 0.00607006088677481 0.013361084643559914 0.024218515826061025 0.030207467794653938 0.014614962367151737 -0.01889180342749871 -0.04443412913733323 -0.050201360992342944; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.000756099037561789 0.0033420072878669726 0.024904744251719995 0.22618954605318292 0.7317720793950104 0.582284620771208 0.6866042591025339 0.33831432540573736 0.09519854226938353 0.02283136931570631 0.008433499200752391 0.0029495595847464483 -0.002148046892144421 -0.0083793737840418 -0.015964153380994984 -0.019738987182315426 -0.008291566843657557 0.015733920651725165 0.034245691104336055 0.03895578330148332; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0007509272744945739 0.0014710361441648348 0.008063057224070832 0.08979648926734561 0.37644956870970486 0.7551760218686556 0.579599893681955 0.7509690001498737 0.4019963703804608 0.14964191794166706 0.06732159282466474 0.03255798213097692 0.013617744728781416 0.008177206948236062 0.009953613126145715 0.012122844601921076 0.007870908413687368 -0.0027747739356427134 -0.011808040176421272 -0.013942055754670462; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0010933780672305626 0.0008426438312307558 0.002747339425887387 0.029139347547010506 0.12555437550781734 0.3160412234568 0.7321331942690971 0.5476636481160299 0.7733446561368161 0.5228258849523095 0.30015314747570176 0.14822385988239573 0.053864978702514 0.014178321608387013 0.0019156636796664787 -0.0008996045266914172 0.0024840535008976523 0.00862917770302064 0.01239036300391782 0.012348067986445884; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0010029715845244203 0.00032291797236906817 0.0006345540636318991 0.006213484451678832 0.026584738715043233 0.08064037739158374 0.31203748389523345 0.7622130558318682 0.4798990266853592 0.7468919646687945 0.5844828076198829 0.30765026330237055 0.11712490041254725 0.03729012800968887 0.015936314608858453 0.010587255311379471 0.004540911141704423 -0.003378040870381006 -0.008340303004659872 -0.00909341958404065; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0012604233552863688 0.00020042858900210121 0.00023340601029869334 0.0017673612171146685 0.006257022136131831 0.01908549016957994 0.10553850689527879 0.407483516586202 0.8253099003974074 0.3818896011665412 0.6384255680668788 0.49786425123130024 0.24931184274521026 0.0913745158530045 0.031879726712965226 0.013900201357947164 0.008564348789880986 0.008126305564241394 0.008576714724509837 0.008130875221301848; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.004673261522189239 0.0005275751998768523 0.00037273466439827105 0.0016452116197411277 0.003575912163823596 0.007998684227319384 0.04646381673101477 0.2183506088477983 0.5406030322752023 0.8475824543762518 0.3950392306957154 0.7062601948609509 0.5805838568716436 0.31085924772074386 0.14745942962691233 0.08013178552578919 0.04253347323784408 0.016258572972928192 0.0026582731020349153 -0.0011585015441411743; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.022892478927629197 0.002369776012448131 0.0011007577728922007 0.0025845211997026314 0.0030969212655942487 0.004410267676370807 0.022371509947614165 0.10714098666486373 0.2757692174546693 0.5024053515494593 0.8235225022755663 0.36736114366996875 0.6945261454289443 0.633166227977119 0.4145642571593715 0.25055045328496856 0.13333221238327456 0.056190000709552615 0.02069962075466177 0.011351724060205659; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.07722264833931936 0.0076780808124464845 0.0024414268892526884 0.0031327522676623857 0.0021157056383434383 0.0019321567023818755 0.008385411698039644 0.03973795754626482 0.10336383282988214 0.21299236381298908 0.47452150176198155 0.8360581365295573 0.30635505138239805 0.6278836459586838 0.6260839649274265 0.43229724883745935 0.2129428586120646 0.06541212290282561 0.007832072511157423 0.0010158152584573902; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.1835510039609558 0.018551114231069425 0.004293223441854103 0.0031750461156396376 0.0012657305195947024 0.0007593391266956595 0.002766548679191313 0.01252986275541879 0.031832768466182736 0.07153772912287462 0.20878964043172557 0.5168887098786058 0.8589770428863565 0.23369189141742402 0.46416002703673276 0.39779588780101094 0.17704189661746386 0.020138612268851358 -0.023997278471858834 -0.011008422711275417; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.3640983576550366 0.046466817120581226 0.009639235131901278 0.004817275991235866 0.0012969793671893117 0.0005420236436424839 0.001521485391672366 0.005749470061052732 0.012507605828791174 0.026868859928768796 0.09121296130185183 0.28837043298022 0.6112228781738439 0.89860009840827 0.17734729139958275 0.34006673203900084 0.2641692805887435 0.09630168400196554 0.008204113055605653 0.006316655894332819; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.6199109131421885 0.12785110691339965 0.0313016027634215 0.013512444910211011 0.003045449638059449 0.000995039824148341 0.0019898941479791986 0.005397773280789716 0.008670921362068158 0.015157670386368121 0.05063472648874113 0.17622413609964763 0.4159432932340139 0.6877850537918145 0.9024459201416005 0.16038348230900584 0.33310191276347617 0.3223371513459543 0.21134352224057826 0.1293263816675643; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.8186732467106017 0.29951497567154806 0.09953610441685301 0.043268847198067645 0.009380841676123798 0.0026201766104041613 0.0036905483603607734 0.006814855455023468 0.007655070755526318 0.010140694767973905 0.030366960655628043 0.10595750831473474 0.25519104275719634 0.4394023031189203 0.650611366658185 0.8879425239532279 0.16816779401419604 0.36939848709505574 0.395554373289144 0.2958120204770125; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.8396227207395545 0.5377384269091086 0.24542729978941608 0.110879085397081 0.023856106697302353 0.005855318526244986 0.005911830672264455 0.007512542172206589 0.005954511097352038 0.005983219425981332 0.01585103047646528 0.05437242366700922 0.13106040359884066 0.2307130303037917 0.379370764743143 0.6305669564270212 0.8940230413025004 0.11731255865900693 0.265298410290254 0.30763188103172084; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.6945434633390949 0.7564489681681593 0.46995366030916136 0.22302927242942652 0.048220172014827936 0.01057074816652166 0.00781306340221759 0.006971538081022406 0.00397123319735068 0.0030637260089022467 0.007180966413035531 0.024047893475625633 0.05757403523141519 0.10277901181800257 0.18568307383293076 0.3711052091886543 0.6540400265326823 0.9044131811185793 0.07192846736054632 0.17622816482926978; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.4762936766011714 0.828818151909036 0.7073369461886921 0.3785043435816474 0.08842076141261883 0.018587147771367517 0.010674319341562221 0.007004876721805198 0.002986718635318442 0.0018010448066119336 0.0036477879415751165 0.01140773409765339 0.025938138188051386 0.04494698968018632 0.08546074908935598 0.1978829483969842 0.4206024784360143 0.6998208525062006 0.9229216758526686 0.04809075252154027], &#39;U&#39;, 0), x = Tuple{SubArray{Float64, 1, Matrix{Float64}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, true}, Int64}[([2.0, 0.0], 1), ([1.8722493084803944, 1.1781761209680564], 1), ([1.2054087302920322, 1.8170664239060492], 1), ([0.1927492468605379, 1.8496886378714485], 1), ([-0.7634822105326886, 1.7873921333439653], 1), ([-1.491074439188309, 1.478876477818158], 1), ([-1.715496730290473, 0.763863564666627], 1), ([-1.6927384267129184, -0.02548281303906763], 1), ([-1.6375083040399991, -0.7603351496646811], 1), ([-1.4020967698225453, -1.3335489511640215], 1), ([-0.8766694239883193, -1.5673446110271225], 1), ([-0.25353811206310417, -1.5733593627742373], 1), ([0.3441060668872955, -1.542770322404427], 1), ([0.8906186118860617, -1.4696252360523447], 1), ([1.2853939931883984, -1.228820867354409], 1), ([1.4436651991698213, -0.804270221306424], 1), ([1.4524849481444388, -0.3168086958982196], 1), ([1.4296700708970633, 0.1559776650721993], 1), ([1.3954544084611666, 0.6029309254295775], 1), ([1.2893454342143849, 0.9891467953863277], 1), ([2.0, 0.0], 2), ([1.8722493084803944, 1.1781761209680564], 2), ([1.2054087302920322, 1.8170664239060492], 2), ([0.1927492468605379, 1.8496886378714485], 2), ([-0.7634822105326886, 1.7873921333439653], 2), ([-1.491074439188309, 1.478876477818158], 2), ([-1.715496730290473, 0.763863564666627], 2), ([-1.6927384267129184, -0.02548281303906763], 2), ([-1.6375083040399991, -0.7603351496646811], 2), ([-1.4020967698225453, -1.3335489511640215], 2), ([-0.8766694239883193, -1.5673446110271225], 2), ([-0.25353811206310417, -1.5733593627742373], 2), ([0.3441060668872955, -1.542770322404427], 2), ([0.8906186118860617, -1.4696252360523447], 2), ([1.2853939931883984, -1.228820867354409], 2), ([1.4436651991698213, -0.804270221306424], 2), ([1.4524849481444388, -0.3168086958982196], 2), ([1.4296700708970633, 0.1559776650721993], 2), ([1.3954544084611666, 0.6029309254295775], 2), ([1.2893454342143849, 0.9891467953863277], 2)], δ = [-0.043711303483780516, -0.310482241639859, -0.9679885818073968, -0.9981745514937379, -0.9925640431588979, -0.6641107188284132, -0.034397323590253395, 0.045578854731326744, 0.1531189470772444, 0.6867685284040238, 0.9917569391235823, 0.9987719487914493, 0.9983253771890384, 0.9627106801116336, 0.62712952663302, 0.11581090255516366, -0.03217748787311947, -0.06244417281112426, -0.10704664464071242, -0.5416232070250678, 0.9990442042010698, 0.9505791800930042, 0.25099423397860116, -0.060395072235034826, -0.12172354015580261, -0.7476342375367839, -0.9994082369731737, -0.9989607439741467, -0.9882077656272268, -0.7268761850506394, -0.128133421480202, 0.04954386245874081, 0.05784843351694462, 0.2705330781974648, 0.7789149869048895, 0.9932712795854708, 0.9994821705634248, 0.998048458383627, 0.9942539996757191, 0.8406213782743576]))</code></pre><p>and optimize</p><pre><code class="language-julia hljs">loss, buildgppost = gp_negloglikelihood(fin_gpmodel, u_mo, y)

p0 = log.(ones(2))
unfl(x) = exp.(x)
optp = gp_train(loss ∘ unfl, p0)
optparams = unfl(optp)</code></pre><pre><code class="nohighlight hljs">2-element Vector{Float64}:
 0.659898864802357
 1.34902131688504</code></pre><p>We build a posterior GP with the optimized parameters,</p><pre><code class="language-julia hljs">optpost = buildgppost(optparams)</code></pre><p>and incorporate into a GP ode model. Unfortunately, this does not currently match the previous implementation.</p><pre><code class="language-julia hljs">gpode = GPODE(optpost, tspan)
gpsol = gpode(u0)

plot(gpsol)</code></pre><p><img src="../2290058427.svg" alt/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../api/">« API</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Wednesday 23 March 2022 14:32">Wednesday 23 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
