<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spiral ODE · GPDiffEq.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GPDiffEq.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../theory/">Theory</a></li><li><a class="tocitem" href="../../symmetries/">Symmetries</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Spiral ODE</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Gradient-data"><span>Gradient data</span></a></li><li><a class="tocitem" href="#Building-a-model"><span>Building a model</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Spiral ODE</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spiral ODE</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Crown421/GPDiffEq.jl/blob/main/examples/spiral/script.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Spiral-ODE"><a class="docs-heading-anchor" href="#Spiral-ODE">Spiral ODE</a><a id="Spiral-ODE-1"></a><a class="docs-heading-anchor-permalink" href="#Spiral-ODE" title="Permalink"></a></h1><p><a href="https://nbviewer.jupyter.org/github/Crown421/GPDiffEq.jl/blob/gh-pages/dev/examples/spiral.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p><em>You are seeing the HTML output generated by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a> from the <a href="https://github.com/Crown421/GPDiffEq.jl/blob/main/examples/spiral/script.jl">Julia source file</a>. The corresponding notebook can be viewed in <a href="https://nbviewer.jupyter.org/github/Crown421/GPDiffEq.jl/blob/gh-pages/dev/examples/spiral.ipynb">nbviewer</a>.</em></p><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><p>Load necessary packages</p><pre><code class="language-julia hljs">using ApproximateGPs
using Plots
using LinearAlgebra
using DifferentialEquations
using InducingPoints
using GPDiffEq</code></pre><p>First we define an ODE and generate some data points from it.</p><pre><code class="language-julia hljs">u0 = [2.0; 0.0]
datasize = 20
tspan = (0.0, 3.0)
datatspan = (0.0, 1.5)
datatsteps = range(datatspan[1], datatspan[2]; length=datasize)

function trueODEfunc(u, p, t)
    du = similar(u)
    true_A = [-0.1 2.0; -2.0 -0.1]
    return du .= ((u .^ 3)&#39;true_A)&#39;
end

prob_trueode = ODEProblem(trueODEfunc, u0, tspan)
sol = solve(prob_trueode, Tsit5())
ode_data = Array(sol(datatsteps))

traj = sol(datatsteps);

p = plot(sol)
scatter!(p, datatsteps, ode_data[1, :]; markersize=4)#, markerstyle = :star)
scatter!(p, datatsteps, ode_data[2, :]; m=(4, :pentagon), lab=&quot;pentagon&quot;)#, markerstyle = :star)</code></pre><p><img src="../1187188243.svg" alt/></p><h2 id="Gradient-data"><a class="docs-heading-anchor" href="#Gradient-data">Gradient data</a><a id="Gradient-data-1"></a><a class="docs-heading-anchor-permalink" href="#Gradient-data" title="Permalink"></a></h2><p>For this example we get gradient observations from our trajectory data via finite differences</p><p>First, we set all necessary variables</p><pre><code class="language-julia hljs">scaker = with_lengthscale(SqExponentialKernel(), 1.0)
moker = IndependentMOKernel(scaker)
##ToDo: make ODE data into col_vecs and add number programmatically
x = MOInput(datatsteps, 2)
σ_n = 1e-6
y = ode_data&#39;[:]</code></pre><p>and build a finite GP from them</p><pre><code class="language-julia hljs">g = GP(moker)
gt = g(x, σ_n)</code></pre><p>Now we use the following convenience functions to a loglikelihood loss function and a function to rebuild the gp with the optimal parameters. Note that we use optimize over the logarithm of the parameters, to ensure their positivity. For more details see <a href="https://juliagaussianprocesses.github.io/KernelFunctions.jl/dev/examples/train-kernel-parameters/">this KernelFunctions.jl example</a></p><pre><code class="language-julia hljs">loss, buildgppost = gp_negloglikelihood(gt, x, y)

p0 = log.([1.0])
unfl(x) = exp.(x)
optp = gp_train(loss ∘ unfl, p0; show_trace=true, show_every=15)
optparams = unfl(optp)</code></pre><pre><code class="nohighlight hljs">1-element Vector{Float64}:
 7.160713088647084</code></pre><p>Now we can build a FiniteGP with the optimized parameters,</p><pre><code class="language-julia hljs">optpost = buildgppost(optparams)</code></pre><p>which fits pretty well</p><pre><code class="language-julia hljs">t_plot = range(datatspan...; length=100)
plot(sol(t_plot); label=[&quot;ode&quot; &quot;&quot;], color=[:skyblue :navy], linewidth=2.5)
t_plot_mo = MOInput(t_plot, 2)
pred_mean = mean(optpost, t_plot_mo)
pred_mean = reshape(pred_mean, :, 2)
# pred_cov = diag(cov(optpost, t_plot_mo))
# pred_cov = reshape(pred_cov, :, 2)
# plot!(t_plot, pred_mean; ribbons = pred_cov)
plot!(
    t_plot,
    pred_mean;
    label=[&quot;gp&quot; &quot;&quot;],
    color=[:tomato :firebrick],
    linewidth=3.5,
    linestyle=:dash,
)</code></pre><p><img src="../2863055322.svg" alt/></p><p>GPs are closed under linear operators, which means that we can very easily obtain derivative information:</p><pre><code class="language-julia hljs">deriv_post = build_deriv_model(optpost)
du_pred_mean = mean(deriv_post, x)
du_pred_mean = reshape(du_pred_mean, :, 2)
du_pred_mean = du_pred_mean ./ norm.(eachrow(du_pred_mean))

du = trueODEfunc.(eachcol(ode_data), 0, 0)
du = du ./ maximum(norm.(du))
quiver(ode_data[1, :], ode_data[2, :]; quiver=(getindex.(du, 1), getindex.(du, 2)))
quiver!(ode_data[1, :], ode_data[2, :]; quiver=(du_pred_mean[:, 1], du_pred_mean[:, 2]))</code></pre><p><img src="../5833590.svg" alt/></p><p>This leaves us with <code>u</code> and <code>udot</code> pairs as in the input and output:</p><pre><code class="language-julia hljs">u = ColVecs(ode_data)
udot = ColVecs(du_pred_mean&#39;)</code></pre><pre><code class="nohighlight hljs">20-element KernelFunctions.ColVecs{Float64, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, SubArray{Float64, 1, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, false}}:
 [-0.04371130303234501, 0.9990442042208214]
 [-0.31048224188536255, 0.9505791800128167]
 [-0.967988581738815, 0.2509942342430949]
 [-0.9981745514807886, -0.06039507244905279]
 [-0.9925640431919466, -0.12172353988631636]
 [-0.6641107189452709, -0.7476342374329814]
 [-0.034397323667447376, -0.9994082369705168]
 [0.04557885467232294, -0.9989607439768389]
 [0.15311894750590507, -0.9882077655608076]
 [0.6867685282184496, -0.7268761852259742]
 [0.9917569390408382, -0.12813342212064405]
 [0.9987719487834845, 0.04954386261930529]
 [0.9983253771900078, 0.05784843350021442]
 [0.9627106802927389, 0.2705330775529899]
 [0.6271295191027246, 0.7789149929677728]
 [0.11581089283061405, 0.9932712807193089]
 [-0.03217748499738198, 0.9994821706560069]
 [-0.062444176348114715, 0.9980484581623307]
 [-0.10704663953685675, 0.9942540002252274]
 [-0.5416232140818269, 0.8406213737275964]</code></pre><h2 id="Building-a-model"><a class="docs-heading-anchor" href="#Building-a-model">Building a model</a><a id="Building-a-model-1"></a><a class="docs-heading-anchor-permalink" href="#Building-a-model" title="Permalink"></a></h2><p>Now we build a model for the the ODE.</p><pre><code class="language-julia hljs">scaker = with_lengthscale(SqExponentialKernel(), ones(2))
moker = IndependentMOKernel(scaker)

u_mo = MOInput(u, 2)
σ_n = 1e-6
y = reduce(vcat, udot.X)</code></pre><p>and build a posterior GP</p><pre><code class="language-julia hljs">gpmodel = GP(moker)
fin_gpmodel = gpmodel(u_mo, σ_n)
post_gpmodel = posterior(fin_gpmodel, y)</code></pre><pre><code class="nohighlight hljs">AbstractGPs.PosteriorGP{AbstractGPs.GP{AbstractGPs.ZeroMean{Float64}, KernelFunctions.IndependentMOKernel{KernelFunctions.TransformedKernel{KernelFunctions.SqExponentialKernel{Distances.Euclidean}, KernelFunctions.ARDTransform{Vector{Float64}}}}}, NamedTuple{(:α, :C, :x, :δ), Tuple{Vector{Float64}, LinearAlgebra.Cholesky{Float64, Matrix{Float64}}, KernelFunctions.MOInputIsotopicByOutputs{SubArray{Float64, 1, Matrix{Float64}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, true}, KernelFunctions.ColVecs{Float64, Matrix{Float64}, SubArray{Float64, 1, Matrix{Float64}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, true}}}, Vector{Float64}}}}(AbstractGPs.GP{AbstractGPs.ZeroMean{Float64}, KernelFunctions.IndependentMOKernel{KernelFunctions.TransformedKernel{KernelFunctions.SqExponentialKernel{Distances.Euclidean}, KernelFunctions.ARDTransform{Vector{Float64}}}}}(AbstractGPs.ZeroMean{Float64}(), Independent Multi-Output Kernel
	Squared Exponential Kernel (metric = Distances.Euclidean(0.0))
	- ARD Transform (dims: 2)), (α = [1.7927791851956107, -17.09163609117613, 16.993197596337236, 1.3346515599735769, -0.3773659411363959, -1.9983049653131872, 2.876518965698415, -2.411276562972048, 3.4668621086634857, -10.080039008169692, 25.118401157190927, -48.07327388489533, 84.66039900176747, -142.27124783947409, 238.59215555351295, -369.1830063708692, 502.71102220124965, -548.8955324362437, 417.2371286894434, -154.75997499943963, 0.9920827582595775, -2.5253727600629814, 2.272251146770008, -1.1250430946303358, 2.5255102427322482, -3.593015503496018, 3.644543247684808, -6.749820327541999, 11.69733958763201, -22.56948431338707, 34.869340974104496, -49.893672544614965, 68.70632468168654, -88.67036338252588, 105.01602830757565, -115.87792711031432, 124.9904725537457, -115.98229661113263, 76.5852883183501, -24.34849717924709], C = LinearAlgebra.Cholesky{Float64, Matrix{Float64}}([1.000000499999875 0.4954890097343885 0.1399383462352052 0.03530424134268343 0.0044457673926741725 0.0007560986593833836 0.0007509268984884519 0.001093377519930028 0.0010029710822528686 0.0012604227256154965 0.004673259173698228 0.022892467463628777 0.07722260977487161 0.18355091225761175 0.36409817717199544 0.6199106059092723 0.8186728373097375 0.8396222994661875 0.6945431152618647 0.4762934388650459 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.49548925747883144 0.8686147829921127 0.6717575882014091 0.20411670261057618 0.02711505117064404 0.0034162079324756033 0.0012651869843569434 0.0003463989927690781 -0.00020036865568367568 -0.00048824522381653334 -0.0020584192175739724 -0.010330459716580963 -0.03521109038539889 -0.08334689547656121 -0.15419934183102563 -0.20642957874766588 -0.12218122259430056 0.14012518313920133 0.47467588012677636 0.682488944144967 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.13993841620436084 0.6528364842988217 0.7274338471275459 0.6275165461916787 0.17190998412415445 0.030936247393645346 0.009771438079872822 0.0032465327796507236 0.0008644072798435157 0.00052926733340167 0.0015142617248522737 0.006649111058155863 0.021016811080686114 0.04755940619207292 0.08560574493893792 0.11440624408174857 0.09217133095644069 0.04646716626809652 0.07408690296449265 0.2504943952784122 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.03530425899479969 0.19479164892546127 0.5985341363382919 0.750542448176164 0.6905210039003836 0.27453815687079147 0.11109297504555432 0.03596437199875397 0.007563255140537312 0.001985761029543246 0.0012659633095865091 -0.00038304007276650904 -0.007454286482751296 -0.021500316833566714 -0.040345878085280486 -0.05066883927955117 -0.024693583551411023 0.03127877952312756 0.07345210438050312 0.08686036974585969 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.004445769615557313 0.025755363171314567 0.14389001582609587 0.6318332735589655 0.7020496490157536 0.7645947471510693 0.42450001166063844 0.14265067492705072 0.030217985256073433 0.006840629220033681 0.003527470052179705 0.003413870031795267 0.006070060889597772 0.013361084652576096 0.024218515908965906 0.030207467700123586 0.014614962052318799 -0.01889180362548652 -0.044434129244327915 -0.05020136130235959 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0007560990374326188 0.0033420072879226017 0.02490474425474805 0.226189546080326 0.7317720794580437 0.5822846206850731 0.6866042590252859 0.33831432520437743 0.09519854214734576 0.022831369288349928 0.008433499186047227 0.0029495595750104334 -0.002148046901682411 -0.008379373795240272 -0.01596415344151699 -0.0197389871095172 -0.008291566610876178 0.015733920810800293 0.0342456912025853 0.038955783534465264 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0007509272739518073 0.0014710361431766105 0.008063057219963927 0.08979648924095918 0.3764495686695929 0.7551760217613493 0.579599893799613 0.7509690000932784 0.4019963701271703 0.14964191783777064 0.06732159275483092 0.03255798207495618 0.013617744694211537 0.008177206933044714 0.009953613142287106 0.01212284459629126 0.007870908344603895 -0.0027747739656703158 -0.011808040171677612 -0.013942055806150674 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0010933780666186515 0.0008426438305487703 0.002747339423614723 0.029139347528081498 0.12555437544877143 0.3160412232657953 0.732133194126492 0.5476636483355891 0.773344656148594 0.5228258848621622 0.3001531474157241 0.14822385975770463 0.053864978579882705 0.014178321542136899 0.0019156636142494872 -0.0008996044587851063 0.0024840536141935467 0.00862917777430176 0.012390363045224369 0.012348068060281039 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0010029715837382843 0.0003229179719626045 0.0006345540627406016 0.006213484443953101 0.026584738686924254 0.08064037728810587 0.31203748368941825 0.7622130557279322 0.47989902690484726 0.7468919646940299 0.5844828078055839 0.30765026322065064 0.1171249002129135 0.03729012790133511 0.01593631451795336 0.010587255281082873 0.004540911077999209 -0.0033780409089950785 -0.00834030302496202 -0.009093419634251487 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0012604233558267018 0.0002004285890296076 0.00023340601027336508 0.0017673612166226422 0.006257022133507449 0.01908549014956017 0.10553850683047614 0.40748351655034337 0.8253099004245065 0.3818896012830064 0.638425568422509 0.49786425159962366 0.24931184269255793 0.09137451574097764 0.03187972648300072 0.013900201380657392 0.008564348872010798 0.008126305628485129 0.008576714766749587 0.00813087527680759 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.004673261510327231 0.0005275751982280707 0.0003727346632581912 0.0016452116157315206 0.003575912157399029 0.007998684213180127 0.04646381668488625 0.21835060881676635 0.5406030324018762 0.847582454663368 0.39503922990424867 0.7062601945279156 0.5805838562775456 0.31085924706746826 0.1474594286204489 0.08013178524425077 0.042533473138786276 0.016258572973933634 0.0026582731305247356 -0.001158501545748706 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.022892478909859647 0.0023697760090033958 0.0011007577708938407 0.002584521194960699 0.0030969212600300607 0.004410267666677376 0.022371509909891313 0.10714098658038877 0.2757692173559496 0.502405351604152 0.8235225019536191 0.36736114393627195 0.6945261457019747 0.633166227540676 0.4145642553822779 0.2505504523071092 0.13333221206983786 0.056190000815485766 0.020699620940311133 0.011351724184364982 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.07722264838616684 0.007678080812427322 0.002441426887401083 0.003132752262957859 0.00211570563377705 0.0019321566964090825 0.00838541167318049 0.03973795746117448 0.10336383264745143 0.21299236360016544 0.4745215009836339 0.8360581361694419 0.30635505201548036 0.6278836465462113 0.6260839641262829 0.432297246434454 0.2129428573789585 0.06541212281434113 0.007832072676535018 0.0010158152882163787 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.18355100403304495 0.018551114222928163 0.0042932234352849865 0.003175046107256799 0.001265730515002695 0.0007593391231002434 0.0027665486661819136 0.0125298627084531 0.031832768362901304 0.07153772897193203 0.2087896398075921 0.5168887092493083 0.8589770427307357 0.23369189187443276 0.4641600278279308 0.3977958843040484 0.1770418941986435 0.0201386117240143 -0.023997278499506676 -0.011008422860733032 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.3640983592210385 0.04646681741096504 0.009639235187198421 0.004817276006345843 0.0012969793678462912 0.0005420236423176474 0.0015214853845539017 0.005749470028128534 0.012507605740863365 0.02686885974611016 0.09121296058586341 0.28837043157183406 0.6112228766262512 0.898600097313266 0.17734729330946938 0.3400667334468346 0.26416928044317645 0.09630168457481325 0.008204113758131489 0.006316656140081002 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.6199109158644978 0.12785110849877301 0.0313016033194421 0.013512445176468367 0.0030454497017880244 0.000995039843827892 0.0019898941780036768 0.0053977733356160625 0.00867092140634876 0.015157670413295559 0.05063472634110581 0.1762241356436839 0.4159432921873005 0.6877850515618205 0.9024459189722173 0.1603834860650871 0.3331019163945191 0.3223371559488959 0.21134352697337372 0.12932638497535345 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.8186732466460539 0.2995149773055846 0.09953610541987093 0.04326884775896206 0.009380841819457907 0.002620176651384114 0.0036905484072053086 0.006814855518852964 0.007655070799899583 0.010140694804435305 0.030366960616738655 0.10595750814865211 0.2551910422223235 0.4394023015342273 0.6506113657817605 0.8879425249189821 0.16816779347153002 0.36939848615623516 0.3955543743935732 0.2958120235184972 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.8396227192772323 0.5377384272575988 0.24542730064488594 0.11087908607925101 0.02385610690022857 0.005855318582942604 0.005911830722814398 0.0075125422263591516 0.005954511130172609 0.005983219455595029 0.015851030486296637 0.05437242368924769 0.13106040358856036 0.23071302988977752 0.37937076513495754 0.6305669593690366 0.8940230424288751 0.1173125572846646 0.26529840840496527 0.30763188074577485 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.6945434625333355 0.7564489670068485 0.4699536601953634 0.22302927293610522 0.048220172241299014 0.010570748236570933 0.007813063457694848 0.006971538133290922 0.003971233226908686 0.0030637260343795185 0.007180966444978327 0.024047893578296457 0.05757403544951748 0.10277901200912463 0.18568307480338322 0.37110521294126425 0.6540400295482298 0.9044131820674947 0.07192846648473486 0.17622816379521533 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.4762936770117058 0.8288181504792247 0.7073369448916661 0.3785043436866993 0.08842076163287693 0.018587147860851035 0.010674319410965838 0.007004876779684728 0.002986718663718019 0.0018010448274263843 0.0036477879716724443 0.011407734191442288 0.02593813839192918 0.04494698994463848 0.08546074992258068 0.19788295159672964 0.4206024822320643 0.6998208549865903 0.9229216765426319 0.048090751793913755 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.000000499999875 0.4954890097343885 0.1399383462352052 0.03530424134268343 0.0044457673926741725 0.0007560986593833836 0.0007509268984884519 0.001093377519930028 0.0010029710822528686 0.0012604227256154965 0.004673259173698228 0.022892467463628777 0.07722260977487161 0.18355091225761175 0.36409817717199544 0.6199106059092723 0.8186728373097375 0.8396222994661875 0.6945431152618647 0.4762934388650459; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.49548925747883144 0.8686147829921127 0.6717575882014091 0.20411670261057618 0.02711505117064404 0.0034162079324756033 0.0012651869843569434 0.0003463989927690781 -0.00020036865568367568 -0.00048824522381653334 -0.0020584192175739724 -0.010330459716580963 -0.03521109038539889 -0.08334689547656121 -0.15419934183102563 -0.20642957874766588 -0.12218122259430056 0.14012518313920133 0.47467588012677636 0.682488944144967; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.13993841620436084 0.6528364842988217 0.7274338471275459 0.6275165461916787 0.17190998412415445 0.030936247393645346 0.009771438079872822 0.0032465327796507236 0.0008644072798435157 0.00052926733340167 0.0015142617248522737 0.006649111058155863 0.021016811080686114 0.04755940619207292 0.08560574493893792 0.11440624408174857 0.09217133095644069 0.04646716626809652 0.07408690296449265 0.2504943952784122; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.03530425899479969 0.19479164892546127 0.5985341363382919 0.750542448176164 0.6905210039003836 0.27453815687079147 0.11109297504555432 0.03596437199875397 0.007563255140537312 0.001985761029543246 0.0012659633095865091 -0.00038304007276650904 -0.007454286482751296 -0.021500316833566714 -0.040345878085280486 -0.05066883927955117 -0.024693583551411023 0.03127877952312756 0.07345210438050312 0.08686036974585969; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.004445769615557313 0.025755363171314567 0.14389001582609587 0.6318332735589655 0.7020496490157536 0.7645947471510693 0.42450001166063844 0.14265067492705072 0.030217985256073433 0.006840629220033681 0.003527470052179705 0.003413870031795267 0.006070060889597772 0.013361084652576096 0.024218515908965906 0.030207467700123586 0.014614962052318799 -0.01889180362548652 -0.044434129244327915 -0.05020136130235959; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0007560990374326188 0.0033420072879226017 0.02490474425474805 0.226189546080326 0.7317720794580437 0.5822846206850731 0.6866042590252859 0.33831432520437743 0.09519854214734576 0.022831369288349928 0.008433499186047227 0.0029495595750104334 -0.002148046901682411 -0.008379373795240272 -0.01596415344151699 -0.0197389871095172 -0.008291566610876178 0.015733920810800293 0.0342456912025853 0.038955783534465264; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0007509272739518073 0.0014710361431766105 0.008063057219963927 0.08979648924095918 0.3764495686695929 0.7551760217613493 0.579599893799613 0.7509690000932784 0.4019963701271703 0.14964191783777064 0.06732159275483092 0.03255798207495618 0.013617744694211537 0.008177206933044714 0.009953613142287106 0.01212284459629126 0.007870908344603895 -0.0027747739656703158 -0.011808040171677612 -0.013942055806150674; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0010933780666186515 0.0008426438305487703 0.002747339423614723 0.029139347528081498 0.12555437544877143 0.3160412232657953 0.732133194126492 0.5476636483355891 0.773344656148594 0.5228258848621622 0.3001531474157241 0.14822385975770463 0.053864978579882705 0.014178321542136899 0.0019156636142494872 -0.0008996044587851063 0.0024840536141935467 0.00862917777430176 0.012390363045224369 0.012348068060281039; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0010029715837382843 0.0003229179719626045 0.0006345540627406016 0.006213484443953101 0.026584738686924254 0.08064037728810587 0.31203748368941825 0.7622130557279322 0.47989902690484726 0.7468919646940299 0.5844828078055839 0.30765026322065064 0.1171249002129135 0.03729012790133511 0.01593631451795336 0.010587255281082873 0.004540911077999209 -0.0033780409089950785 -0.00834030302496202 -0.009093419634251487; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0012604233558267018 0.0002004285890296076 0.00023340601027336508 0.0017673612166226422 0.006257022133507449 0.01908549014956017 0.10553850683047614 0.40748351655034337 0.8253099004245065 0.3818896012830064 0.638425568422509 0.49786425159962366 0.24931184269255793 0.09137451574097764 0.03187972648300072 0.013900201380657392 0.008564348872010798 0.008126305628485129 0.008576714766749587 0.00813087527680759; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.004673261510327231 0.0005275751982280707 0.0003727346632581912 0.0016452116157315206 0.003575912157399029 0.007998684213180127 0.04646381668488625 0.21835060881676635 0.5406030324018762 0.847582454663368 0.39503922990424867 0.7062601945279156 0.5805838562775456 0.31085924706746826 0.1474594286204489 0.08013178524425077 0.042533473138786276 0.016258572973933634 0.0026582731305247356 -0.001158501545748706; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.022892478909859647 0.0023697760090033958 0.0011007577708938407 0.002584521194960699 0.0030969212600300607 0.004410267666677376 0.022371509909891313 0.10714098658038877 0.2757692173559496 0.502405351604152 0.8235225019536191 0.36736114393627195 0.6945261457019747 0.633166227540676 0.4145642553822779 0.2505504523071092 0.13333221206983786 0.056190000815485766 0.020699620940311133 0.011351724184364982; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.07722264838616684 0.007678080812427322 0.002441426887401083 0.003132752262957859 0.00211570563377705 0.0019321566964090825 0.00838541167318049 0.03973795746117448 0.10336383264745143 0.21299236360016544 0.4745215009836339 0.8360581361694419 0.30635505201548036 0.6278836465462113 0.6260839641262829 0.432297246434454 0.2129428573789585 0.06541212281434113 0.007832072676535018 0.0010158152882163787; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.18355100403304495 0.018551114222928163 0.0042932234352849865 0.003175046107256799 0.001265730515002695 0.0007593391231002434 0.0027665486661819136 0.0125298627084531 0.031832768362901304 0.07153772897193203 0.2087896398075921 0.5168887092493083 0.8589770427307357 0.23369189187443276 0.4641600278279308 0.3977958843040484 0.1770418941986435 0.0201386117240143 -0.023997278499506676 -0.011008422860733032; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.3640983592210385 0.04646681741096504 0.009639235187198421 0.004817276006345843 0.0012969793678462912 0.0005420236423176474 0.0015214853845539017 0.005749470028128534 0.012507605740863365 0.02686885974611016 0.09121296058586341 0.28837043157183406 0.6112228766262512 0.898600097313266 0.17734729330946938 0.3400667334468346 0.26416928044317645 0.09630168457481325 0.008204113758131489 0.006316656140081002; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.6199109158644978 0.12785110849877301 0.0313016033194421 0.013512445176468367 0.0030454497017880244 0.000995039843827892 0.0019898941780036768 0.0053977733356160625 0.00867092140634876 0.015157670413295559 0.05063472634110581 0.1762241356436839 0.4159432921873005 0.6877850515618205 0.9024459189722173 0.1603834860650871 0.3331019163945191 0.3223371559488959 0.21134352697337372 0.12932638497535345; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.8186732466460539 0.2995149773055846 0.09953610541987093 0.04326884775896206 0.009380841819457907 0.002620176651384114 0.0036905484072053086 0.006814855518852964 0.007655070799899583 0.010140694804435305 0.030366960616738655 0.10595750814865211 0.2551910422223235 0.4394023015342273 0.6506113657817605 0.8879425249189821 0.16816779347153002 0.36939848615623516 0.3955543743935732 0.2958120235184972; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.8396227192772323 0.5377384272575988 0.24542730064488594 0.11087908607925101 0.02385610690022857 0.005855318582942604 0.005911830722814398 0.0075125422263591516 0.005954511130172609 0.005983219455595029 0.015851030486296637 0.05437242368924769 0.13106040358856036 0.23071302988977752 0.37937076513495754 0.6305669593690366 0.8940230424288751 0.1173125572846646 0.26529840840496527 0.30763188074577485; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.6945434625333355 0.7564489670068485 0.4699536601953634 0.22302927293610522 0.048220172241299014 0.010570748236570933 0.007813063457694848 0.006971538133290922 0.003971233226908686 0.0030637260343795185 0.007180966444978327 0.024047893578296457 0.05757403544951748 0.10277901200912463 0.18568307480338322 0.37110521294126425 0.6540400295482298 0.9044131820674947 0.07192846648473486 0.17622816379521533; 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.4762936770117058 0.8288181504792247 0.7073369448916661 0.3785043436866993 0.08842076163287693 0.018587147860851035 0.010674319410965838 0.007004876779684728 0.002986718663718019 0.0018010448274263843 0.0036477879716724443 0.011407734191442288 0.02593813839192918 0.04494698994463848 0.08546074992258068 0.19788295159672964 0.4206024822320643 0.6998208549865903 0.9229216765426319 0.048090751793913755], &#39;U&#39;, 0), x = Tuple{SubArray{Float64, 1, Matrix{Float64}, Tuple{Base.Slice{Base.OneTo{Int64}}, Int64}, true}, Int64}[([2.0, 0.0], 1), ([1.872249308489606, 1.1781761209770223], 1), ([1.2054087302990313, 1.8170664239165057], 1), ([0.19274924685910425, 1.8496886378770663], 1), ([-0.7634822105398524, 1.7873921333388556], 1), ([-1.4910744391582855, 1.478876478004551], 1), ([-1.7154967304737785, 0.7638635647212483], 1), ([-1.6927384268631536, -0.025482813230253254], 1), ([-1.6375083041769367, -0.7603351500404292], 1), ([-1.4020967696254747, -1.333548951345314], 1), ([-0.8766694245869815, -1.5673446115478238], 1), ([-0.25353811203451904, -1.5733593633085305], 1), ([0.344106067629918, -1.5427703228082779], 1), ([0.8906186129809912, -1.4696252366116351], 1), ([1.285393995831459, -1.2288208653913129], 1), ([1.443665197475394, -0.8042702146741737], 1), ([1.452484945443323, -0.31680869147896945], 1), ([1.4296700683248307, 0.15597766683284076], 1), ([1.3954544059625245, 0.6029309248483916], 1), ([1.289345432053107, 0.9891467929621599], 1), ([2.0, 0.0], 2), ([1.872249308489606, 1.1781761209770223], 2), ([1.2054087302990313, 1.8170664239165057], 2), ([0.19274924685910425, 1.8496886378770663], 2), ([-0.7634822105398524, 1.7873921333388556], 2), ([-1.4910744391582855, 1.478876478004551], 2), ([-1.7154967304737785, 0.7638635647212483], 2), ([-1.6927384268631536, -0.025482813230253254], 2), ([-1.6375083041769367, -0.7603351500404292], 2), ([-1.4020967696254747, -1.333548951345314], 2), ([-0.8766694245869815, -1.5673446115478238], 2), ([-0.25353811203451904, -1.5733593633085305], 2), ([0.344106067629918, -1.5427703228082779], 2), ([0.8906186129809912, -1.4696252366116351], 2), ([1.285393995831459, -1.2288208653913129], 2), ([1.443665197475394, -0.8042702146741737], 2), ([1.452484945443323, -0.31680869147896945], 2), ([1.4296700683248307, 0.15597766683284076], 2), ([1.3954544059625245, 0.6029309248483916], 2), ([1.289345432053107, 0.9891467929621599], 2)], δ = [-0.04371130303234501, -0.31048224188536255, -0.967988581738815, -0.9981745514807886, -0.9925640431919466, -0.6641107189452709, -0.034397323667447376, 0.04557885467232294, 0.15311894750590507, 0.6867685282184496, 0.9917569390408382, 0.9987719487834845, 0.9983253771900078, 0.9627106802927389, 0.6271295191027246, 0.11581089283061405, -0.03217748499738198, -0.062444176348114715, -0.10704663953685675, -0.5416232140818269, 0.9990442042208214, 0.9505791800128167, 0.2509942342430949, -0.06039507244905279, -0.12172353988631636, -0.7476342374329814, -0.9994082369705168, -0.9989607439768389, -0.9882077655608076, -0.7268761852259742, -0.12813342212064405, 0.04954386261930529, 0.05784843350021442, 0.2705330775529899, 0.7789149929677728, 0.9932712807193089, 0.9994821706560069, 0.9980484581623307, 0.9942540002252274, 0.8406213737275964]))</code></pre><p>and optimize</p><pre><code class="language-julia hljs">loss, buildgppost = gp_negloglikelihood(fin_gpmodel, u_mo, y)

p0 = log.(ones(2))
unfl(x) = exp.(x)
optp = gp_train(loss ∘ unfl, p0)
optparams = unfl(optp)</code></pre><pre><code class="nohighlight hljs">2-element Vector{Float64}:
 0.6598988631139324
 1.3490213440119543</code></pre><p>We build a posterior GP with the optimized parameters,</p><pre><code class="language-julia hljs">optpost = buildgppost(optparams)</code></pre><p>and incorporate into a GP ode model. Unfortunately, this does not currently match the previous implementation.</p><pre><code class="language-julia hljs">gpode = GPODE(optpost, tspan)
gpsol = gpode(u0)

plot(gpsol)</code></pre><p><img src="../2290058427.svg" alt/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../api/">« API</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Thursday 28 July 2022 06:14">Thursday 28 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
